generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "mongodb"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_DATABASE_URL")
}

model User {
  id        String      @id @default(auto()) @map("_id") @db.ObjectId
  userId    String      @unique
  name      String
  email     String      @unique
  image     String
  createdAt DateTime?   @default(now())
  updatedAt DateTime?   @updatedAt
  workspace Workspace[]
  Member    Member[]
  role      Role?
  Project   Project[]
}

model Workspace {
  id          String    @id @default(auto()) @map("_id") @db.ObjectId
  name        String    @unique
  description String?
  Owner       User      @relation(fields: [ownerId], references: [userId])
  ownerId     String
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  projects    Project[]
}

enum Role {
  youtuber
  editor
}

model Project {
  id          String    @id @default(auto()) @map("_id") @db.ObjectId
  Workspace   Workspace @relation(fields: [workspaceId], references: [id])
  workspaceId String    @db.ObjectId
  Owner       User      @relation(fields: [ownerId], references: [userId])
  ownerId     String
  name        String    @unique
  description String?   @default("")
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  Video       Video[]
  members     Member[]
}

model Member {
  id               String        @id @default(auto()) @map("_id") @db.ObjectId
  User             User?         @relation(fields: [userId], references: [userId])
  userId           String?
  email            String?
  role             Role
  Project          Project       @relation(fields: [projectId], references: [id])
  projectId        String        @db.ObjectId
  status           MemberStatus?
  inviteCode       String?
  inviteCodeExpiry DateTime?
}

enum MemberStatus {
  pending
  accepted
  rejected
}

model Video {
  id                      String   @id @default(auto()) @map("_id") @db.ObjectId
  title                   String
  description             String
  keywords                String[]
  tags                    String[]
  category                String
  defaultLanguage         String
  privacyStatus           String
  embeddable              Boolean?
  license                 String?
  publishAt               DateTime
  thumbnail               String?
  selfDeclaredMadeForKids Boolean?
  url                     String?
  duration                Int?
  channelId               String?
  uploadStatus            String
  failureReason           String?
  isApproved              Boolean?
  Project                 Project  @relation(fields: [projectId], references: [id])
  projectId               String   @db.ObjectId
}
